!function(){"use strict";function r(r,a,o){a.UserInfo={Username:"",Email:"",ConfPassword:"",Password:""},a.showLog=!0,a.showReg=!1,a.switchLogin=function(){a.showLog=!0,a.showReg=!1},a.switchReg=function(){a.showLog=!1,a.showReg=!0},a.registerUser=function(){if(n(a.UserInfo)){var e={Username:a.UserInfo.Username,Password:a.UserInfo.Password,Email:a.UserInfo.Email};r.post("/register",e).then(function(r){201==r.status?(a.message="User created succesfully. You need to login",a.UserInfo={}):(a.UserInfo.Password={},a.UserInfo.ConfPassword={},a.message=r.data)}).finally(function(){})}};var n=function(r){a.regValid={Username:{valid:!0,errorMessage:""},Email:{valid:!0,errorMessage:""},Password:{valid:!0,errorMessage:{lengthError:"",alphaError:"",digitError:"",upperError:""}},ConfPassword:{valid:!0,errorMessage:""}};var o=!0;return(r.Username.length<3||r.Username.length>32)&&(a.regValid.Username.valid=!1,a.regValid.Username.errorMessage="Username must be between 3 and 32 characters long",o=!1),s(r.Email)||(a.regValid.Email.valid=!1,a.regValid.Email.errorMessage="Email address is not valid",o=!1),e(r.Password,1)||(a.regValid.Password.valid=!1,a.regValid.Password.errorMessage.lengthError="Must contains at least 8 characters",o=!1),e(r.Password,2)||(a.regValid.Password.valid=!1,a.regValid.Password.errorMessage.alphaError="Must have at least one non alphanumeric character",o=!1),e(r.Password,3)||(a.regValid.Password.valid=!1,a.regValid.Password.errorMessage.digitError="Must have at least one digit ('0'-'9')",o=!1),e(r.Password,4)||(a.regValid.Password.valid=!1,a.regValid.Password.errorMessage.upperError="Must have at least one uppercase ('A'-'Z')",o=!1),r.Password!=r.ConfPassword&&(a.regValid.ConfPassword.valid=!1,a.regValid.ConfPassword.errorMessage="Passwords do not match",o=!1),o}}function e(r,e){switch(e){case 1:var s=/[A-Za-z\d$@#$^!%*?&]{8,}/;return s.test(r);case 2:var s=/^(?=.*[$@#$!%^*?&])[A-Za-z\d$@#$^!%*?&]/;return s.test(r);case 3:var s=/^(?=.*\d)[A-Za-z\d$@#$^!%*?&]/;return s.test(r);case 4:var s=/^(?=.*[A-Z])[A-Za-z\d$@#$^!%*?&]/;return s.test(r)}}function s(r){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{1,}))$/;return e.test(r)}angular.module("app-auth").controller("authenticationController",r)}();